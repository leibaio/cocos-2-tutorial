{"version":3,"sources":["assets\\scripts\\Player.js"],"names":["cc","Class","Component","properties","jumpHeight","jumpDuration","maxMoveSpeed","accel","runJumpAction","jumpUp","tween","by","y","easing","jumpDown","sequence","repeatForever","onKeyDown","event","keyCode","macro","KEY","a","accLeft","d","accRight","onKeyUp","onLoad","jumpAction","node","then","start","speedX","systemEvent","on","SystemEvent","EventType","KEY_DOWN","KEY_UP","update","dt","Math","abs","x","onDestroy","off"],"mappings":"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","sourceRoot":"/","sourcesContent":["cc.Class({\n  extends: cc.Component,\n\n  properties: {\n    // 主角跳跃高度\n    jumpHeight: 0,\n    // 主角跳跃持续时间\n    jumpDuration: 0,\n    // 最大移动速度\n    maxMoveSpeed: 0,\n    // 加速度\n    accel: 0,\n  },\n\n  runJumpAction() {\n    // 跳跃动作\n    let jumpUp = cc\n      .tween()\n      .by(this.jumpDuration, { y: this.jumpHeight }, { easing: \"sineOut\" });\n    // 下落\n    let jumpDown = cc\n      .tween()\n      .by(this.jumpDuration, { y: -this.jumpHeight }, { easing: \"sineIn\" });\n\n    // 创建一个缓动，按 jumpUp、jumpDown 顺序执行\n    let tween = cc.tween().sequence(jumpUp, jumpDown);\n    // 不断重复\n    return cc.tween().repeatForever(tween);\n  },\n\n  onKeyDown(event) {\n    switch (event.keyCode) {\n      case cc.macro.KEY.a:\n        this.accLeft = true;\n        break;\n      case cc.macro.KEY.d:\n        this.accRight = true;\n        break;\n    }\n  },\n\n  onKeyUp(event) {\n    switch (event.keyCode) {\n      case cc.macro.KEY.a:\n        this.accLeft = false;\n        break;\n      case cc.macro.KEY.d:\n        this.accRight = false;\n        break;\n    }\n  },\n\n  // LIFE-CYCLE CALLBACKS:\n\n  onLoad() {\n    // 初始化跳跃动作\n    let jumpAction = this.runJumpAction();\n    cc.tween(this.node).then(jumpAction).start();\n\n    // 加速度方向开关\n    this.accLeft = false;\n    this.accRight = false;\n    // 当前水平方向速度\n    this.speedX = 0;\n\n    // 初始化键盘输入监听\n    cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\n    cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);\n  },\n\n  start() {},\n\n  update(dt) {\n    // 根据当前加速度方向每帧更新速度\n    if (this.accLeft) {\n      this.speedX -= this.accel * dt;\n    } else if (this.accRight) {\n      this.speedX += this.accel * dt;\n    }\n\n    // 限制最大速度\n    if (Math.abs(this.speedX) > this.maxMoveSpeed) {\n      // 不允许超过最大速度\n      this.speedX = (this.maxMoveSpeed * this.speedX) / Math.abs(this.speedX);\n    }\n    // 根据当前速度更新位置\n    this.node.x += this.speedX * dt;\n  },\n\n  onDestroy() {\n    // 取消键盘输入监听\n    cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\n    cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);\n  },\n});\n"]}